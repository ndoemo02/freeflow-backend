import http from 'node:http';

const PORT = process.env.PORT || 5050;
const ok = (res, obj) => { res.writeHead(200, {'Content-Type':'application/json'}); res.end(JSON.stringify(obj)); };

const srv = http.createServer((req,res) => {
  if (req.url.startsWith('/api/health')) return ok(res, {
    ok: true,
    host: req.headers.host,
    time: new Date().toISOString()
  });
  ok(res, { ok:true, msg:'UP', url:req.url });
});

srv.listen(PORT, '0.0.0.0', () => {
  console.log(`UP on http://localhost:${PORT}`);
}).on('error', (e) => {
  console.error('Listen error:', e);
  process.exit(1);
});
